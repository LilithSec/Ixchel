com2sec readonly  default         [% config.snmp.community %]

[% IF config.snmp.v3_limited_enable %]
createUser '[% config.snmp.v3_limited_user %]' MD5 '[% config.snmp.v3_limited_pass %]'
[% END %]

group Ixchelsnmp v2c        readonly

[% IF config.snmp.v3_limited_enable %]
group client usm '[% config.snmp.v3_limited_user %]'

view client excluded  .1
# hostname
view client included  .1.3.6.1.2.1.1.5
# uptime
view client included  .1.3.6.1.2.1.1.3.0
# interfaces
view client included  .1.3.6.1.2.1.2.2.1.2
view client included  .1.3.6.1.2.1.2.2.1.10
view client included  .1.3.6.1.2.1.2.2.1.10.4
view client included  .1.3.6.1.2.1.2.2.1.16
view client included  .1.3.6.1.2.1.2.2.1.16.4
# load
view client included  .1.3.6.1.4.1.2021.10.1.3.1
view client included  .1.3.6.1.4.1.2021.10.1.3.2
view client included  .1.3.6.1.4.1.2021.10.1.3.3
# CPU times
view client included  .1.3.6.1.4.1.2021.11.9.0
view client included  .1.3.6.1.4.1.2021.11.50.0
view client included  .1.3.6.1.4.1.2021.11.10.0
view client included  .1.3.6.1.4.1.2021.11.52.0
view client included  .1.3.6.1.4.1.2021.11.11.0
view client included  .1.3.6.1.4.1.2021.11.53.0
view client included  .1.3.6.1.4.1.2021.11.51.0
# RAM
view client included  .1.3.6.1.4.1.2021.4.3.0
view client included  .1.3.6.1.4.1.2021.4.4.0
view client included  .1.3.6.1.4.1.2021.4.5.0
view client included  .1.3.6.1.4.1.2021.4.6.0
view client included  .1.3.6.1.4.1.2021.4.11.0
view client included  .1.3.6.1.4.1.2021.4.13.0
view client included  .1.3.6.1.4.1.2021.4.14.0
view client included  .1.3.6.1.4.1.2021.4.15.0
# DISK
view client included  .1.3.6.1.4.1.2021.9.1.2.1
view client included  .1.3.6.1.4.1.2021.9.1.3.1
view client included  .1.3.6.1.4.1.2021.9.1.6.1
view client included  .1.3.6.1.4.1.2021.9.1.7.1
view client included  .1.3.6.1.4.1.2021.9.1.8.1
view client included  .1.3.6.1.4.1.2021.9.1.9.1
view client included  .1.3.6.1.4.1.2021.9.1.10.1
view none excluded  .1
[% END %]

view all    included  .1                               80

access Ixchelsnmp  ""      any       noauth    exact  all    none   none

[% IF config.snmp.v3_limited_enable %]
access client   ""      usm       noauth    exact  none    none   none
access client   ""      usm       auth      exact  client  none   none
[% END %]

syslocation '[% config.snmp.syslocation %]'
syscontact '[% config.snmp.syslocation %]'

extend distro [% config.snmp.extend_base_dir %]/distro
extend manufacturer /bin/echo '[% sys_info.Host.manufacturer %]'
extend hardware /bin/echo '[% sys_info.Host.product %]'
extend serial /bin/echo '[% sys_info.Host.product %]'	

extend osupdate /bin/cat /var/cache/osupdate.extend

[% PERL %]
if ( -f '/usr/lib/libcmaX64.so' ) {
   print '# HP RAID monitoring
master          agentx
dlmod cmaX /usr/lib/libcmaX64.so';
}
[% END %]

[% IF config.nptd.enable && config.snmp.extends.ntp.enable %]
extend ntp-client /usr/bin/env [% config.snmp.extend_env %] [% config.snmp.extend_base_dir %]/ntp-client
[% END %]
[% IF config.snmp.extends.linux_softnet_stat.enable %]
extend linux_softnet_stat /usr/bin/env [% config.snmp.extend_env %] [% config.snmp.extend_base_dir %]/linux_softnet_stat
[% END %]
[% IF config.suricata.enable && config.snmp.extends.suricata.enable %]
extend suricata-stats /usr/bin/env [% config.snmp.extend_env %] suricata_stat_check -c -b
[% END %]
[% IF config.suricata.enable && config.suricata_extract.enable && config.snmp.extends.suricata_extract.enable %]
extend suricata_extract /usr/bin/env [% config.snmp.extend_env %] suricata_extract_submit_extend
[% END %]
[% IF config.sneck.enable && config.snmp.extends.sneck.enable %]
extend /usr/bin/env [% config.snmp.extend_env %] sneck -c -b
[% END %]
[% IF config.fail2ban.enable && config.snmp.extends.fail2ban.enable %]
extend /usr/bin/env [% config.snmp.extend_env %] [% config.snmp.extend_base_dir %]/fail2ban -c
[% END %]
[% IF ( config.opensearch.enable || config.elasticsearch.enable ) && config.snmp.extends.opensearch.enable %]
extend opensearch /bin/cat /var/cache/opensearch.json
[% END %]
[% IF config.snmp.extends.logsize.enable %]
extend logsize /bin/cat /var/cache/logsize_extend/extend_return
[% END %]
[% IF config.mysql.enable && config.snmp.extends.mysql.enable %]
extend mysql /usr/bin/env [% config.snmp.extend_env %] [% config.snmp.extend_base_dir %]/mysql
[% END %]
[% IF config.snmp.extends.hv_monitor.enable %]
extend hv-monitor /bin/cat /var/cache/hv-monitor.json'
[% END %]
[% IF config.snmp.extends.systemd.enable %]
[% PERL %]
if ( -f '/usr/bin/systemctl' || -f /bin/systemctl ) %]{
   print 'extend systemd /bin/cat /var/cache/systemd.extend';
}
[% END %]
[% END %]
[% IF config.supervisord.enable && config.snmp.extends.supervisord.enable %]
extend supervisord /bin/cat /var/cache/supervisord.extend
[% END %]
[% IF sys_info.VirtInfo.virtualization_role != 'guest' %]
extend smart /bin/cat /var/cache/smart
[% END %]
[% IF config.privoxy.enable && config.snmp.extends.systemd.enable %]
extend privoxy /usr/bin/env [% config.snmp.extend_env %] [% config.snmp.extend_base_dir %]/privoxy
[% END %]
[% IF config.chronyd.enable && config.snmp.extends.chronyd.enable %]
extend chronyd /usr/bin/env [% config.snmp.extend_env %] [% config.snmp.extend_base_dir %]/chronyd
[% END %]
[% IF config.zfs.enable && config.snmp.extends.zfs.enable %]
extend chronyd /usr/bin/env [% config.snmp.extend_env %] [% config.snmp.extend_base_dir %]/zfs
[% END %]
[% IF config.squid.enable && config.snmp.extends.squid.enable %]
proxy -v 2c -c public 127.0.0.1:3401 1.3.6.1.4.1.3495
[% END %]
[% IF config.snmp.extends.ifAlias.enable %]
pass .1.3.6.1.2.1.31.1.1.1.18 [% config.snmp.extend_base_dir %]/ifAlias
[% END %]

agentaddress udp:127.0.0.1
agentaddress tcp:127.0.0.1
